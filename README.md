# mymoviedb

A Haskell ETL app that retrieves movie information from [The Movie DB](https://www.themoviedb.org).
The app uses the [movieDB API](https://developers.themoviedb.org/3/getting-started) , in order to retrieve the data in JSON format. Then the data are parsed and then transformed and finally stored in a star schema in a Postgresql database for analytics queries, via a daily load ETL process. This app essentially implements this daily ETL process.
In the 	**data_model.pptx** presentation found in the misc/ directory you can see an overview of the target data model.
Also, in the same folder you can find the DDL script (misc/**ddl_script.sql**) for creating this data model in Postgresql).
### How to run
Download or clone mymoviedb in a new directory, then run `stack build`
with the [stack](https://docs.haskellstack.org/en/stable/README/) tool
Then in order to execute, run `stack exec -- mymoviedb `
### Sample Output
```
$ stack exec -- mymoviedb


*** Target date to load: 2018-05-22 18:53:06.497098 UTC ***

Countries for which to load movies: 
GR 
US 
GB 
CA 

[("GR",[MovieCore {id = 299536, title = "Avengers: Infinity War", original_language = "en"},MovieCore {id = 383498, title = "Deadpool 2", original_language = "en"},MovieCore {id = 427641, title = "Rampage", original_language = "en"},MovieCore {id = 348350, title = "Solo: A Star Wars Story", original_language = "en"},MovieCore {id = 447332, title = "A Quiet Place", original_language = "en"},MovieCore {id = 460019, title = "Truth or Dare", original_language = "en"},MovieCore {id = 385332, title = "Terminal", original_language = "en"},MovieCore {id = 467938, title = "Revenge", original_language = "en"},MovieCore {id = 396806, title = "Anon", original_language = "en"},MovieCore {id = 437557, title = "Blockers", original_language = "en"},MovieCore {id = 470114, title = "24 Hours to Live", original_language = "en"},MovieCore {id = 399174, title = "Isle of Dogs", original_language = "en"},MovieCore {id = 454619, title = "Overboard", original_language = "en"},MovieCore {id = 419478, title = "Midnight Sun", original_language = "en"},MovieCore {id = 434355, title = "Taxi 5", original_language = "fr"},MovieCore {id = 291276, title = "Unlocked", original_language = "en"},MovieCore {id = 203835, title = "Amityville: The Awakening", original_language = "en"},MovieCore {id = 335777, title = "The Nut Job 2: Nutty by Nature", original_language = "en"},MovieCore {id = 339987, title = "The Exception", original_language = "en"},MovieCore {id = 427348, title = "Carbone", original_language = "fr"}]),("US",[MovieCore {id = 299536, title = "Avengers: Infinity War", original_language = "en"},MovieCore {id = 383498, title = "Deadpool 2", original_language = "en"},MovieCore {id = 427641, title = "Rampage", original_language = "en"},MovieCore {id = 348350, title = "Solo: A Star Wars Story", original_language = "en"},MovieCore {id = 460019, title = "Truth or Dare", original_language = "en"},MovieCore {id = 385332, title = "Terminal", original_language = "en"},MovieCore {id = 467938, title = "Revenge", original_language = "en"},MovieCore {id = 398181, title = "You Were Never Really Here", original_language = "en"},MovieCore {id = 521647, title = "Darc", original_language = "en"},MovieCore {id = 492336, title = "Deep Blue Sea 2", original_language = "en"},MovieCore {id = 502682, title = "Book Club", original_language = "en"},MovieCore {id = 454619, title = "Overboard", original_language = "en"},MovieCore {id = 458737, title = "First Reformed", original_language = "en"},MovieCore {id = 497814, title = "Breaking In", original_language = "en"},MovieCore {id = 399366, title = "Marrowbone", original_language = "en"},MovieCore {id = 454615, title = "Black Water", original_language = "en"},MovieCore {id = 399796, title = "Life of the Party", original_language = "en"},MovieCore {id = 505205, title = "Pope Francis: A Man of His Word", original_language = "en"},MovieCore {id = 411135, title = "Future World", original_language = "en"},MovieCore {id = 504331, title = "Hurricane Bianca: From Russia with Hate", original_language = "en"}]),("GB",[MovieCore {id = 299536, title = "Avengers: Infinity War", original_language = "en"},MovieCore {id = 383498, title = "Deadpool 2", original_language = "en"},MovieCore {id = 427641, title = "Rampage", original_language = "en"},MovieCore {id = 348350, title = "Solo: A Star Wars Story", original_language = "en"},MovieCore {id = 460019, title = "Truth or Dare", original_language = "en"},MovieCore {id = 385332, title = "Terminal", original_language = "en"},MovieCore {id = 467938, title = "Revenge", original_language = "en"},MovieCore {id = 474392, title = "Samson", original_language = "en"},MovieCore {id = 497814, title = "Breaking In", original_language = "en"},MovieCore {id = 399796, title = "Life of the Party", original_language = "en"},MovieCore {id = 370567, title = "Sherlock Gnomes", original_language = "en"},MovieCore {id = 403431, title = "Brigsby Bear", original_language = "en"},MovieCore {id = 449749, title = "The Leisure Seeker", original_language = "en"},MovieCore {id = 375327, title = "Submergence", original_language = "en"},MovieCore {id = 362826, title = "Wildling", original_language = "en"},MovieCore {id = 425148, title = "Show Dogs", original_language = "en"},MovieCore {id = 400579, title = "Tully", original_language = "en"},MovieCore {id = 371608, title = "The Strangers: Prey at Night", original_language = "en"},MovieCore {id = 460064, title = "Edie", original_language = "en"},MovieCore {id = 522758, title = "Hooligan Escape The Russian Job", original_language = "en"}]),("CA",[MovieCore {id = 299536, title = "Avengers: Infinity War", original_language = "en"},MovieCore {id = 383498, title = "Deadpool 2", original_language = "en"},MovieCore {id = 447332, title = "A Quiet Place", original_language = "en"},MovieCore {id = 398181, title = "You Were Never Really Here", original_language = "en"},MovieCore {id = 419743, title = "Disobedience", original_language = "en"},MovieCore {id = 524394, title = "La maison des Syriens", original_language = "fr"},MovieCore {id = 525383, title = "Fucking My Way Back Home", original_language = "en"},MovieCore {id = 471616, title = "Indian Horse", original_language = "en"},MovieCore {id = 505593, title = "La Bolduc", original_language = "fr"},MovieCore {id = 521288, title = "The Trough", original_language = "en"},MovieCore {id = 524447, title = "Innu Nikamu: Chanter la r\233sistance", original_language = "fr"},MovieCore {id = 514968, title = "Granny Project", original_language = "en"},MovieCore {id = 515660, title = "The Broker", original_language = "fa"},MovieCore {id = 522884, title = "Standing Up", original_language = "en"},MovieCore {id = 514813, title = "After Auschwitz", original_language = "en"},MovieCore {id = 520759, title = "This Mountain Life", original_language = "en"},MovieCore {id = 522012, title = "Bhalo Theko", original_language = "bn"},MovieCore {id = 515677, title = "Slut or Nut: The Diary of a Rape Trial", original_language = "en"},MovieCore {id = 412059, title = "Mobile Homes", original_language = "en"},MovieCore {id = 522393, title = "Recovery Boys", original_language = "en"}])]

OK. Downloaded now-playing movies in countries.

Downloading details for each movie...
[("GR",Movie (MovieCore {id = 299536, title = "Avengers: Infinity War", original_language = "en"}) (MovieDetail {original_title = "Avengers: Infinity War", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Adventure"},Genre {name = "Science Fiction"},Genre {name = "Fantasy"},Genre {name = "Action"}], release_date = "2018-04-25", popularity = 530.896529})),("GR",Movie (MovieCore {id = 383498, title = "Deadpool 2", original_language = "en"}) (MovieDetail {original_title = "Deadpool 2", production_countries = [ProductionCountry {iso_3166_1 = "CA"},ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Action"},Genre {name = "Comedy"},Genre {name = "Science Fiction"}], release_date = "2018-05-15", popularity = 252.72172})),("GR",Movie (MovieCore {id = 427641, title = "Rampage", original_language = "en"}) (MovieDetail {original_title = "Rampage", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Action"},Genre {name = "Adventure"},Genre {name = "Science Fiction"}], release_date = "2018-04-12", popularity = 127.437633})),("GR",Movie (MovieCore {id = 348350, title = "Solo: A Star Wars Story", original_language = "en"}) (MovieDetail {original_title = "Solo: A Star Wars Story", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Action"},Genre {name = "Adventure"},Genre {name = "Science Fiction"}], release_date = "2018-05-23", popularity = 53.873943})),("GR",Movie (MovieCore {id = 447332, title = "A Quiet Place", original_language = "en"}) (MovieDetail {original_title = "A Quiet Place", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Drama"},Genre {name = "Horror"},Genre {name = "Thriller"},Genre {name = "Science Fiction"}], release_date = "2018-04-05", popularity = 50.695363})),("GR",Movie (MovieCore {id = 460019, title = "Truth or Dare", original_language = "en"}) (MovieDetail {original_title = "Truth or Dare", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Thriller"},Genre {name = "Horror"}], release_date = "2018-04-12", popularity = 40.583452})),("GR",Movie (MovieCore {id = 385332, title = "Terminal", original_language = "en"}) (MovieDetail {original_title = "Terminal", production_countries = [ProductionCountry {iso_3166_1 = "US"},ProductionCountry {iso_3166_1 = "GB"},ProductionCountry {iso_3166_1 = "HK"},ProductionCountry {iso_3166_1 = "IE"},ProductionCountry {iso_3166_1 = "HU"}], genres = [Genre {name = "Thriller"},Genre {name = "Drama"},Genre {name = "Crime"}], release_date = "2018-05-11", popularity = 35.569907})),("GR",Movie (MovieCore {id = 467938, title = "Revenge", original_language = "en"}) (MovieDetail {original_title = "Revenge", production_countries = [ProductionCountry {iso_3166_1 = "FR"}], genres = [Genre {name = "Action"},Genre {name = "Thriller"},Genre {name = "Horror"}], release_date = "2018-02-07", popularity = 33.288962})),("GR",Movie (MovieCore {id = 396806, title = "Anon", original_language = "en"}) (MovieDetail {original_title = "Anon", production_countries = [ProductionCountry {iso_3166_1 = "DE"}], genres = [Genre {name = "Science Fiction"},Genre {name = "Thriller"}], release_date = "2018-05-03", popularity = 27.746602})),("GR",Movie (MovieCore {id = 437557, title = "Blockers", original_language = "en"}) (MovieDetail {original_title = "Blockers", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Comedy"}], release_date = "2018-03-30", popularity = 27.515593})),("GR",Movie (MovieCore {id = 470114, title = "24 Hours to Live", original_language = "en"}) (MovieDetail {original_title = "24 Hours to Live", production_countries = [ProductionCountry {iso_3166_1 = "US"},ProductionCountry {iso_3166_1 = "ZA"},ProductionCountry {iso_3166_1 = "CN"}], genres = [Genre {name = "Action"},Genre {name = "Science Fiction"},Genre {name = "Thriller"},Genre {name = "Mystery"}], release_date = "2017-10-26", popularity = 24.006281})),("GR",Movie (MovieCore {id = 399174, title = "Isle of Dogs", original_language = "en"}) (MovieDetail {original_title = "Isle of Dogs", production_countries = [ProductionCountry {iso_3166_1 = "DE"},ProductionCountry {iso_3166_1 = "GB"},ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Adventure"},Genre {name = "Comedy"},Genre {name = "Animation"}], release_date = "2018-03-23", popularity = 18.719908})),("GR",Movie (MovieCore {id = 454619, title = "Overboard", original_language = "en"}) (MovieDetail {original_title = "Overboard", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Romance"},Genre {name = "Comedy"}], release_date = "2018-05-03", popularity = 17.159815})),("GR",Movie (MovieCore {id = 419478, title = "Midnight Sun", original_language = "en"}) (MovieDetail {original_title = "Midnight Sun", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Romance"},Genre {name = "Drama"}], release_date = "2018-03-22", popularity = 14.930265})),("GR",Movie (MovieCore {id = 434355, title = "Taxi 5", original_language = "fr"}) (MovieDetail {original_title = "Taxi 5", production_countries = [ProductionCountry {iso_3166_1 = "FR"}], genres = [Genre {name = "Comedy"},Genre {name = "Action"}], release_date = "2018-04-11", popularity = 14.0407})),("GR",Movie (MovieCore {id = 291276, title = "Unlocked", original_language = "en"}) (MovieDetail {original_title = "Unlocked", production_countries = [ProductionCountry {iso_3166_1 = "CZ"},ProductionCountry {iso_3166_1 = "CH"},ProductionCountry {iso_3166_1 = "GB"},ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Action"},Genre {name = "Thriller"}], release_date = "2017-04-27", popularity = 13.48835})),("GR",Movie (MovieCore {id = 203835, title = "Amityville: The Awakening", original_language = "en"}) (MovieDetail {original_title = "Amityville: The Awakening", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Thriller"},Genre {name = "Horror"}], release_date = "2017-07-20", popularity = 11.974111})),("GR",Movie (MovieCore {id = 335777, title = "The Nut Job 2: Nutty by Nature", original_language = "en"}) (MovieDetail {original_title = "The Nut Job 2: Nutty by Nature", production_countries = [ProductionCountry {iso_3166_1 = "US"},ProductionCountry {iso_3166_1 = "CA"},ProductionCountry {iso_3166_1 = "KR"}], genres = [Genre {name = "Family"},Genre {name = "Animation"},Genre {name = "Adventure"},Genre {name = "Comedy"}], release_date = "2017-08-11", popularity = 8.309602})),("GR",Movie (MovieCore {id = 339987, title = "The Exception", original_language = "en"}) (MovieDetail {original_title = "A Exce\231\227o", production_countries = [ProductionCountry {iso_3166_1 = "GB"},ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Drama"}], release_date = "2017-06-02", popularity = 8.272281})),("GR",Movie (MovieCore {id = 427348, title = "Carbone", original_language = "fr"}) (MovieDetail {original_title = "Carbone", production_countries = [], genres = [Genre {name = "Thriller"}], release_date = "2017-11-01", popularity = 7.460526})),("US",Movie (MovieCore {id = 299536, title = "Avengers: Infinity War", original_language = "en"}) (MovieDetail {original_title = "Avengers: Infinity War", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Adventure"},Genre {name = "Science Fiction"},Genre {name = "Fantasy"},Genre {name = "Action"}], release_date = "2018-04-25", popularity = 530.896529})),("US",Movie (MovieCore {id = 383498, title = "Deadpool 2", original_language = "en"}) (MovieDetail {original_title = "Deadpool 2", production_countries = [ProductionCountry {iso_3166_1 = "CA"},ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Action"},Genre {name = "Comedy"},Genre {name = "Science Fiction"}], release_date = "2018-05-15", popularity = 252.72172})),("US",Movie (MovieCore {id = 427641, title = "Rampage", original_language = "en"}) (MovieDetail {original_title = "Rampage", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Action"},Genre {name = "Adventure"},Genre {name = "Science Fiction"}], release_date = "2018-04-12", popularity = 127.437633})),("US",Movie (MovieCore {id = 348350, title = "Solo: A Star Wars Story", original_language = "en"}) (MovieDetail {original_title = "Solo: A Star Wars Story", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Action"},Genre {name = "Adventure"},Genre {name = "Science Fiction"}], release_date = "2018-05-23", popularity = 53.873943})),("US",Movie (MovieCore {id = 460019, title = "Truth or Dare", original_language = "en"}) (MovieDetail {original_title = "Truth or Dare", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Thriller"},Genre {name = "Horror"}], release_date = "2018-04-12", popularity = 40.583452})),("US",Movie (MovieCore {id = 385332, title = "Terminal", original_language = "en"}) (MovieDetail {original_title = "Terminal", production_countries = [ProductionCountry {iso_3166_1 = "US"},ProductionCountry {iso_3166_1 = "GB"},ProductionCountry {iso_3166_1 = "HK"},ProductionCountry {iso_3166_1 = "IE"},ProductionCountry {iso_3166_1 = "HU"}], genres = [Genre {name = "Thriller"},Genre {name = "Drama"},Genre {name = "Crime"}], release_date = "2018-05-11", popularity = 35.569907})),("US",Movie (MovieCore {id = 467938, title = "Revenge", original_language = "en"}) (MovieDetail {original_title = "Revenge", production_countries = [ProductionCountry {iso_3166_1 = "FR"}], genres = [Genre {name = "Action"},Genre {name = "Thriller"},Genre {name = "Horror"}], release_date = "2018-02-07", popularity = 33.288962})),("US",Movie (MovieCore {id = 398181, title = "You Were Never Really Here", original_language = "en"}) (MovieDetail {original_title = "You Were Never Really Here", production_countries = [ProductionCountry {iso_3166_1 = "FR"},ProductionCountry {iso_3166_1 = "GB"},ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Drama"},Genre {name = "Thriller"},Genre {name = "Crime"}], release_date = "2017-11-08", popularity = 20.849619})),("US",Movie (MovieCore {id = 521647, title = "Darc", original_language = "en"}) (MovieDetail {original_title = "Darc", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Action"},Genre {name = "Thriller"}], release_date = "2018-05-01", popularity = 19.756547})),("US",Movie (MovieCore {id = 492336, title = "Deep Blue Sea 2", original_language = "en"}) (MovieDetail {original_title = "Deep Blue Sea 2", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Science Fiction"},Genre {name = "Horror"},Genre {name = "Action"}], release_date = "2018-04-17", popularity = 18.018502})),("US",Movie (MovieCore {id = 502682, title = "Book Club", original_language = "en"}) (MovieDetail {original_title = "Book Club", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Comedy"},Genre {name = "Romance"}], release_date = "2018-05-18", popularity = 17.569145})),("US",Movie (MovieCore {id = 454619, title = "Overboard", original_language = "en"}) (MovieDetail {original_title = "Overboard", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Romance"},Genre {name = "Comedy"}], release_date = "2018-05-03", popularity = 17.159815})),("US",Movie (MovieCore {id = 458737, title = "First Reformed", original_language = "en"}) (MovieDetail {original_title = "First Reformed", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Thriller"},Genre {name = "Drama"}], release_date = "2018-05-18", popularity = 16.766274})),("US",Movie (MovieCore {id = 497814, title = "Breaking In", original_language = "en"}) (MovieDetail {original_title = "Breaking In", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Thriller"}], release_date = "2018-05-05", popularity = 14.838073})),("US",Movie (MovieCore {id = 399366, title = "Marrowbone", original_language = "en"}) (MovieDetail {original_title = "Marrowbone", production_countries = [ProductionCountry {iso_3166_1 = "ES"}], genres = [Genre {name = "Drama"},Genre {name = "Horror"},Genre {name = "Thriller"},Genre {name = "Mystery"}], release_date = "2017-10-27", popularity = 14.137279})),("US",Movie (MovieCore {id = 454615, title = "Black Water", original_language = "en"}) (MovieDetail {original_title = "Black Water", production_countries = [], genres = [Genre {name = "Action"},Genre {name = "Drama"}], release_date = "2018-05-18", popularity = 13.697412})),("US",Movie (MovieCore {id = 399796, title = "Life of the Party", original_language = "en"}) (MovieDetail {original_title = "Life of the Party", production_countries = [], genres = [Genre {name = "Comedy"}], release_date = "2018-05-11", popularity = 13.502018})),("US",Movie (MovieCore {id = 505205, title = "Pope Francis: A Man of His Word", original_language = "en"}) (MovieDetail {original_title = "Pope Francis: A Man of His Word", production_countries = [], genres = [Genre {name = "Documentary"}], release_date = "2018-05-18", popularity = 13.006918})),("US",Movie (MovieCore {id = 411135, title = "Future World", original_language = "en"}) (MovieDetail {original_title = "Future World", production_countries = [], genres = [Genre {name = "Science Fiction"}], release_date = "2018-05-25", popularity = 12.491371})),("US",Movie (MovieCore {id = 504331, title = "Hurricane Bianca: From Russia with Hate", original_language = "en"}) (MovieDetail {original_title = "Hurricane Bianca: From Russia with Hate", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Comedy"}], release_date = "2018-05-18", popularity = 11.740615})),("GB",Movie (MovieCore {id = 299536, title = "Avengers: Infinity War", original_language = "en"}) (MovieDetail {original_title = "Avengers: Infinity War", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Adventure"},Genre {name = "Science Fiction"},Genre {name = "Fantasy"},Genre {name = "Action"}], release_date = "2018-04-25", popularity = 530.896529})),("GB",Movie (MovieCore {id = 383498, title = "Deadpool 2", original_language = "en"}) (MovieDetail {original_title = "Deadpool 2", production_countries = [ProductionCountry {iso_3166_1 = "CA"},ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Action"},Genre {name = "Comedy"},Genre {name = "Science Fiction"}], release_date = "2018-05-15", popularity = 252.72172})),("GB",Movie (MovieCore {id = 427641, title = "Rampage", original_language = "en"}) (MovieDetail {original_title = "Rampage", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Action"},Genre {name = "Adventure"},Genre {name = "Science Fiction"}], release_date = "2018-04-12", popularity = 127.437633})),("GB",Movie (MovieCore {id = 348350, title = "Solo: A Star Wars Story", original_language = "en"}) (MovieDetail {original_title = "Solo: A Star Wars Story", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Action"},Genre {name = "Adventure"},Genre {name = "Science Fiction"}], release_date = "2018-05-23", popularity = 53.873943})),("GB",Movie (MovieCore {id = 460019, title = "Truth or Dare", original_language = "en"}) (MovieDetail {original_title = "Truth or Dare", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Thriller"},Genre {name = "Horror"}], release_date = "2018-04-12", popularity = 40.583452})),("GB",Movie (MovieCore {id = 385332, title = "Terminal", original_language = "en"}) (MovieDetail {original_title = "Terminal", production_countries = [ProductionCountry {iso_3166_1 = "US"},ProductionCountry {iso_3166_1 = "GB"},ProductionCountry {iso_3166_1 = "HK"},ProductionCountry {iso_3166_1 = "IE"},ProductionCountry {iso_3166_1 = "HU"}], genres = [Genre {name = "Thriller"},Genre {name = "Drama"},Genre {name = "Crime"}], release_date = "2018-05-11", popularity = 35.569907})),("GB",Movie (MovieCore {id = 467938, title = "Revenge", original_language = "en"}) (MovieDetail {original_title = "Revenge", production_countries = [ProductionCountry {iso_3166_1 = "FR"}], genres = [Genre {name = "Action"},Genre {name = "Thriller"},Genre {name = "Horror"}], release_date = "2018-02-07", popularity = 33.288962})),("GB",Movie (MovieCore {id = 474392, title = "Samson", original_language = "en"}) (MovieDetail {original_title = "Samson", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Action"},Genre {name = "Drama"},Genre {name = "Adventure"}], release_date = "2018-02-16", popularity = 15.060235})),("GB",Movie (MovieCore {id = 497814, title = "Breaking In", original_language = "en"}) (MovieDetail {original_title = "Breaking In", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Thriller"}], release_date = "2018-05-05", popularity = 14.838073})),("GB",Movie (MovieCore {id = 399796, title = "Life of the Party", original_language = "en"}) (MovieDetail {original_title = "Life of the Party", production_countries = [], genres = [Genre {name = "Comedy"}], release_date = "2018-05-11", popularity = 13.502018})),("GB",Movie (MovieCore {id = 370567, title = "Sherlock Gnomes", original_language = "en"}) (MovieDetail {original_title = "Sherlock Gnomes", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Romance"},Genre {name = "Animation"},Genre {name = "Comedy"},Genre {name = "Family"},Genre {name = "Fantasy"},Genre {name = "Mystery"}], release_date = "2018-03-15", popularity = 12.060658})),("GB",Movie (MovieCore {id = 403431, title = "Brigsby Bear", original_language = "en"}) (MovieDetail {original_title = "Brigsby Bear", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Comedy"},Genre {name = "Drama"}], release_date = "2017-07-27", popularity = 11.906878})),("GB",Movie (MovieCore {id = 449749, title = "The Leisure Seeker", original_language = "en"}) (MovieDetail {original_title = "The Leisure Seeker", production_countries = [ProductionCountry {iso_3166_1 = "FR"},ProductionCountry {iso_3166_1 = "IT"}], genres = [Genre {name = "Drama"},Genre {name = "Comedy"}], release_date = "2018-01-03", popularity = 11.352013})),("GB",Movie (MovieCore {id = 375327, title = "Submergence", original_language = "en"}) (MovieDetail {original_title = "Submergence", production_countries = [ProductionCountry {iso_3166_1 = "FR"},ProductionCountry {iso_3166_1 = "DE"},ProductionCountry {iso_3166_1 = "ES"},ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Drama"},Genre {name = "Thriller"},Genre {name = "Romance"}], release_date = "2018-02-15", popularity = 11.191505})),("GB",Movie (MovieCore {id = 362826, title = "Wildling", original_language = "en"}) (MovieDetail {original_title = "Wildling", production_countries = [ProductionCountry {iso_3166_1 = "DE"},ProductionCountry {iso_3166_1 = "SE"},ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Horror"},Genre {name = "Fantasy"}], release_date = "2018-04-13", popularity = 10.56789})),("GB",Movie (MovieCore {id = 425148, title = "Show Dogs", original_language = "en"}) (MovieDetail {original_title = "Show Dogs", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Comedy"}], release_date = "2018-05-10", popularity = 10.346488})),("GB",Movie (MovieCore {id = 400579, title = "Tully", original_language = "en"}) (MovieDetail {original_title = "Tully", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Comedy"},Genre {name = "Drama"}], release_date = "2018-05-04", popularity = 10.271649})),("GB",Movie (MovieCore {id = 371608, title = "The Strangers: Prey at Night", original_language = "en"}) (MovieDetail {original_title = "The Strangers: Prey at Night", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Horror"},Genre {name = "Thriller"}], release_date = "2018-03-07", popularity = 10.08903})),("GB",Movie (MovieCore {id = 460064, title = "Edie", original_language = "en"}) (MovieDetail {original_title = "Edie", production_countries = [ProductionCountry {iso_3166_1 = "GB"}], genres = [Genre {name = "Drama"}], release_date = "2018-05-25", popularity = 9.810476})),("GB",Movie (MovieCore {id = 522758, title = "Hooligan Escape The Russian Job", original_language = "en"}) (MovieDetail {original_title = "Hooligan Escape The Russian Job", production_countries = [], genres = [Genre {name = "Crime"}], release_date = "2018-05-18", popularity = 7.710871})),("CA",Movie (MovieCore {id = 299536, title = "Avengers: Infinity War", original_language = "en"}) (MovieDetail {original_title = "Avengers: Infinity War", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Adventure"},Genre {name = "Science Fiction"},Genre {name = "Fantasy"},Genre {name = "Action"}], release_date = "2018-04-25", popularity = 530.896529})),("CA",Movie (MovieCore {id = 383498, title = "Deadpool 2", original_language = "en"}) (MovieDetail {original_title = "Deadpool 2", production_countries = [ProductionCountry {iso_3166_1 = "CA"},ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Action"},Genre {name = "Comedy"},Genre {name = "Science Fiction"}], release_date = "2018-05-15", popularity = 252.72172})),("CA",Movie (MovieCore {id = 447332, title = "A Quiet Place", original_language = "en"}) (MovieDetail {original_title = "A Quiet Place", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Drama"},Genre {name = "Horror"},Genre {name = "Thriller"},Genre {name = "Science Fiction"}], release_date = "2018-04-05", popularity = 50.695363})),("CA",Movie (MovieCore {id = 398181, title = "You Were Never Really Here", original_language = "en"}) (MovieDetail {original_title = "You Were Never Really Here", production_countries = [ProductionCountry {iso_3166_1 = "FR"},ProductionCountry {iso_3166_1 = "GB"},ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Drama"},Genre {name = "Thriller"},Genre {name = "Crime"}], release_date = "2017-11-08", popularity = 20.849619})),("CA",Movie (MovieCore {id = 419743, title = "Disobedience", original_language = "en"}) (MovieDetail {original_title = "Disobedience", production_countries = [ProductionCountry {iso_3166_1 = "IE"},ProductionCountry {iso_3166_1 = "US"},ProductionCountry {iso_3166_1 = "GB"}], genres = [Genre {name = "Drama"},Genre {name = "Romance"}], release_date = "2018-04-27", popularity = 10.531248})),("CA",Movie (MovieCore {id = 524394, title = "La maison des Syriens", original_language = "fr"}) (MovieDetail {original_title = "La maison des Syriens", production_countries = [], genres = [Genre {name = "Documentary"}], release_date = "2018-05-11", popularity = 3.3152})),("CA",Movie (MovieCore {id = 525383, title = "Fucking My Way Back Home", original_language = "en"}) (MovieDetail {original_title = "Fucking My Way Back Home", production_countries = [ProductionCountry {iso_3166_1 = "CA"}], genres = [], release_date = "2018-05-20", popularity = 2.8})),("CA",Movie (MovieCore {id = 471616, title = "Indian Horse", original_language = "en"}) (MovieDetail {original_title = "Indian Horse", production_countries = [ProductionCountry {iso_3166_1 = "CA"}], genres = [Genre {name = "Drama"}], release_date = "2018-04-13", popularity = 2.589728})),("CA",Movie (MovieCore {id = 505593, title = "La Bolduc", original_language = "fr"}) (MovieDetail {original_title = "La Bolduc", production_countries = [ProductionCountry {iso_3166_1 = "CA"}], genres = [Genre {name = "Drama"}], release_date = "2018-04-06", popularity = 2.548022})),("CA",Movie (MovieCore {id = 521288, title = "The Trough", original_language = "en"}) (MovieDetail {original_title = "\20302\22739\27133", production_countries = [], genres = [], release_date = "2018-05-04", popularity = 2.400494})),("CA",Movie (MovieCore {id = 524447, title = "Innu Nikamu: Chanter la r\233sistance", original_language = "fr"}) (MovieDetail {original_title = "Innu Nikamu: Chanter la r\233sistance", production_countries = [], genres = [Genre {name = "Documentary"}], release_date = "2018-05-04", popularity = 2.253682})),("CA",Movie (MovieCore {id = 514968, title = "Granny Project", original_language = "en"}) (MovieDetail {original_title = "Granny Project", production_countries = [ProductionCountry {iso_3166_1 = "HU"},ProductionCountry {iso_3166_1 = "GB"}], genres = [Genre {name = "Documentary"}], release_date = "2017-07-11", popularity = 2.178521})),("CA",Movie (MovieCore {id = 515660, title = "The Broker", original_language = "fa"}) (MovieDetail {original_title = "The Broker", production_countries = [], genres = [Genre {name = "Documentary"}], release_date = "2018-04-30", popularity = 1.957424})),("CA",Movie (MovieCore {id = 522884, title = "Standing Up", original_language = "en"}) (MovieDetail {original_title = "Standing Up", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Comedy"},Genre {name = "Documentary"}], release_date = "2018-05-08", popularity = 1.80411})),("CA",Movie (MovieCore {id = 514813, title = "After Auschwitz", original_language = "en"}) (MovieDetail {original_title = "After Auschwitz", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Documentary"}], release_date = "2018-04-14", popularity = 1.794203})),("CA",Movie (MovieCore {id = 520759, title = "This Mountain Life", original_language = "en"}) (MovieDetail {original_title = "This Mountain Life", production_countries = [ProductionCountry {iso_3166_1 = "CA"}], genres = [Genre {name = "Documentary"},Genre {name = "Adventure"}], release_date = "2018-04-30", popularity = 1.750435})),("CA",Movie (MovieCore {id = 522012, title = "Bhalo Theko", original_language = "bn"}) (MovieDetail {original_title = "Bhalo Theko", production_countries = [ProductionCountry {iso_3166_1 = "BD"}], genres = [], release_date = "2018-05-04", popularity = 1.727653})),("CA",Movie (MovieCore {id = 515677, title = "Slut or Nut: The Diary of a Rape Trial", original_language = "en"}) (MovieDetail {original_title = "Slut or Nut: The Diary of a Rape Trial", production_countries = [], genres = [Genre {name = "Documentary"}], release_date = "2018-05-02", popularity = 1.647555})),("CA",Movie (MovieCore {id = 412059, title = "Mobile Homes", original_language = "en"}) (MovieDetail {original_title = "Mobile Homes", production_countries = [ProductionCountry {iso_3166_1 = "FR"},ProductionCountry {iso_3166_1 = "CA"}], genres = [Genre {name = "Drama"}], release_date = "2018-04-04", popularity = 1.548172})),("CA",Movie (MovieCore {id = 522393, title = "Recovery Boys", original_language = "en"}) (MovieDetail {original_title = "Recovery Boys", production_countries = [ProductionCountry {iso_3166_1 = "US"}], genres = [Genre {name = "Documentary"}], release_date = "2018-05-01", popularity = 1.517733}))]

Succesfully loaded Movies Dimension
59 movie records have been inserted in Movie _Dim

Succesfully loaded MOVIE_PLAYING_FCT
80 movie records have been inserted in MOVIE_PLAYING_FCT

Succesfully loaded MOVIES_PER_COUNTRY_MON_AGG
4 movie records have been inserted in MOVIES_PER_COUNTRY_MON_AGG
ETL process completed succesfully!
```
### Sample Database Output from the Target Data Model
```
select *
from public."MOVIE_PLAYING_FCT"
limit 20;

 movie_id | date_playing | country_playing 
----------+--------------+-----------------
   299536 | 2018-05-22   | GR
   383498 | 2018-05-22   | GR
   427641 | 2018-05-22   | GR
   348350 | 2018-05-22   | GR
   447332 | 2018-05-22   | GR
   460019 | 2018-05-22   | GR
   385332 | 2018-05-22   | GR
   467938 | 2018-05-22   | GR
   396806 | 2018-05-22   | GR
   437557 | 2018-05-22   | GR
   470114 | 2018-05-22   | GR
   399174 | 2018-05-22   | GR
   454619 | 2018-05-22   | GR
   419478 | 2018-05-22   | GR
   434355 | 2018-05-22   | GR
   291276 | 2018-05-22   | GR
   203835 | 2018-05-22   | GR
   335777 | 2018-05-22   | GR
   339987 | 2018-05-22   | GR
   427348 | 2018-05-22   | GR
(20 rows)

select *
from public."MOVIES_DIM"
limit 20;

 movie_id |                  title                  | original_language |             original_title              | production_countries |                  genres                   | release_date | popularity 
----------+-----------------------------------------+-------------------+-----------------------------------------+----------------------+-------------------------------------------+--------------+------------
   348350 | Solo: A Star Wars Story                 | en                | Solo: A Star Wars Story                 | US,                  | Action,Adventure,Science Fiction,         | 2018-05-23   |         54
   504331 | Hurricane Bianca: From Russia with Hate | en                | Hurricane Bianca: From Russia with Hate | US,                  | Comedy,                                   | 2018-05-18   |         12
   522012 | Bhalo Theko                             | bn                | Bhalo Theko                             | BD,                  |                                           | 2018-05-04   |          2
   203835 | Amityville: The Awakening               | en                | Amityville: The Awakening               | US,                  | Thriller,Horror,                          | 2017-07-20   |         12
   411135 | Future World                            | en                | Future World                            |                      | Science Fiction,                          | 2018-05-25   |         12
   299536 | Avengers: Infinity War                  | en                | Avengers: Infinity War                  | US,                  | Adventure,Science Fiction,Fantasy,Action, | 2018-04-25   |        531
   520759 | This Mountain Life                      | en                | This Mountain Life                      | CA,                  | Documentary,Adventure,                    | 2018-04-30   |          2
   467938 | Revenge                                 | en                | Revenge                                 | FR,                  | Action,Thriller,Horror,                   | 2018-02-07   |         33
   474392 | Samson                                  | en                | Samson                                  | US,                  | Action,Drama,Adventure,                   | 2018-02-16   |         15
   362826 | Wildling                                | en                | Wildling                                | DE,SE,US,            | Horror,Fantasy,                           | 2018-04-13   |         11
   427348 | Carbone                                 | fr                | Carbone                                 |                      | Thriller,                                 | 2017-11-01   |          7
   437557 | Blockers                                | en                | Blockers                                | US,                  | Comedy,                                   | 2018-03-30   |         28
   449749 | The Leisure Seeker                      | en                | The Leisure Seeker                      | FR,IT,               | Drama,Comedy,                             | 2018-01-03   |         11
   447332 | A Quiet Place                           | en                | A Quiet Place                           | US,                  | Drama,Horror,Thriller,Science Fiction,    | 2018-04-05   |         51
   515677 | Slut or Nut: The Diary of a Rape Trial  | en                | Slut or Nut: The Diary of a Rape Trial  |                      | Documentary,                              | 2018-05-02   |          2
   471616 | Indian Horse                            | en                | Indian Horse                            | CA,                  | Drama,                                    | 2018-04-13   |          3
   521647 | Darc                                    | en                | Darc                                    | US,                  | Action,Thriller,                          | 2018-05-01   |         20
   427641 | Rampage                                 | en                | Rampage                                 | US,                  | Action,Adventure,Science Fiction,         | 2018-04-12   |        127
   454619 | Overboard                               | en                | Overboard                               | US,                  | Romance,Comedy,                           | 2018-05-03   |         17
   470114 | 24 Hours to Live                        | en                | 24 Hours to Live                        | US,ZA,CN,            | Action,Science Fiction,Thriller,Mystery,  | 2017-10-26   |         24
(20 rows)

select *
from public."MOVIES_PER_COUNTRY_MON_AGG"
limit 20;

 yearmonth | country | num_movies 
-----------+---------+------------
 2018-05   | CA      |         20
 2018-05   | GB      |         20
 2018-05   | GR      |         20
 2018-05   | US      |         20
(4 rows)

```
